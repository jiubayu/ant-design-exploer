"use strict";(self.webpackChunkant_design_explorer=self.webpackChunkant_design_explorer||[]).push([[143],{"./src/components/upload/upload.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,default:()=>upload_stories,defaultUpload:()=>defaultUpload,imgUpload:()=>imgUpload});var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,react=__webpack_require__("./node_modules/react/index.js"),taggedTemplateLiteral=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),styles=__webpack_require__("./src/components/shared/styles.tsx"),axios=__webpack_require__("./node_modules/axios/lib/axios.js"),components_button=__webpack_require__("./src/components/button/index.tsx"),message=__webpack_require__("./src/components/message/index.tsx"),progress=__webpack_require__("./src/components/progress/index.tsx"),icon=__webpack_require__("./src/components/icon/index.tsx"),modal=__webpack_require__("./src/components/modal/index.tsx"),animation=__webpack_require__("./src/components/shared/animation.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function chooseProgressListColor(status){switch(status){case"ready":return styles.yW.warning;case"success":return styles.yW.positive;case"failed":return styles.yW.negative;case"upload":return styles.yW.secondary}}const ProgressBarListItemName=styled_components_browser_esm.Ay.div(_templateObject||(_templateObject=(0,taggedTemplateLiteral.A)(["\n  color: ",";\n"])),(props=>chooseProgressListColor(props.status))),updateFilist=(setFlist,_file,uploadPartial)=>{setFlist((preVFlist=>preVFlist?preVFlist.map((f=>f.uid===_file.uid?{...f,...uploadPartial}:f)):preVFlist))},postData=function(file,filename,config,i,onProgress,setFlist,successCallback,failCallback){const formData=new FormData;formData.append(filename,file);const source=axios.A.CancelToken.source(),_file={filename:file.name,percent:0,status:"ready",uid:Date.now()+"upload",size:file.size,cancel:source,raw:file};setFlist((prev=>[_file,...prev]));const mergeConfig={...{method:"post",url:"http://localhost:51111/user/uploadAvatar/",data:formData,headers:{"Content-Type":"multipart/form-data"},cancelToken:source.token,onUploadProgress:e=>{console.log(e.total,e.loaded,"e.loaded");const percentage=Math.round(100*e.loaded/e.total)||0;updateFilist(setFlist,_file,{status:"upload",percent:percentage}),onProgress&&onProgress(percentage,file,i)}},...config};return(0,axios.A)(mergeConfig).then((res=>{updateFilist(setFlist,_file,{status:"success",percent:100}),successCallback&&successCallback(res,i)})).catch((err=>{updateFilist(setFlist,_file,{status:"failed",percent:0}),failCallback&&failCallback(err,i)}))},resolveFilename=function(uploadFilename,index){return Array.isArray(uploadFilename)?uploadFilename[index]:uploadFilename},getBase64=(raw,callback)=>{const reader=new FileReader;reader.addEventListener("load",(()=>{callback(reader.result)})),reader.readAsDataURL(raw)};function UploadList(props){const{flist,onRemove}=props;return(0,jsx_runtime.jsx)("ul",{children:flist.map((f=>(0,jsx_runtime.jsx)(ProgressLi,{children:(0,jsx_runtime.jsxs)(ProgressListItem,{children:[(0,jsx_runtime.jsx)(ProgressBarListItemName,{status:f.status,children:f.filename}),(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(components_button.Ay,{style:{padding:0,background:"transparent"},onClick:()=>onRemove(f),children:(0,jsx_runtime.jsx)(icon.A,{icon:"close",color:chooseProgressListColor(f.status)})})}),("upload"===f.status||"ready"===f.status)&&(0,jsx_runtime.jsx)(progress.A,{count:f.percent})]})},f.uid)))})}const IconSpin=styled_components_browser_esm.Ay.span(_templateObject2||(_templateObject2=(0,taggedTemplateLiteral.A)(["\n  & > svg {\n    ","\n  }\n"])),(0,styled_components_browser_esm.AH)(_templateObject3||(_templateObject3=(0,taggedTemplateLiteral.A)(["\n      animation: "," 2s linear infinite;\n    "])),animation.G0));function ImageList(props){const{flist,onRemove,setFlist}=props;return(0,react.useMemo)((()=>{flist&&flist.forEach((f=>{f.raw&&!f.img&&getBase64(f.raw,(e=>{updateFilist(setFlist,f,{img:e||"error"})}))}))}),[flist,setFlist]),(0,jsx_runtime.jsx)(react.Fragment,{children:flist.map((f=>(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsxs)(ImgWraper,{children:["success"===f.status&&(0,jsx_runtime.jsx)("img",{src:f.img,alt:"upload img"}),("upload"===f.status||"ready"===f.status)&&(0,jsx_runtime.jsx)(IconSpin,{children:(0,jsx_runtime.jsx)(icon.A,{icon:"sync",color:styles.yW.warning})}),"failed"===f.status&&(0,jsx_runtime.jsx)(IconSpin,{children:(0,jsx_runtime.jsx)(icon.A,{icon:"photo",color:styles.yW.negative})}),(0,jsx_runtime.jsx)(ImageCloseButton,{className:"closebtn",onClick:()=>onRemove(f),children:(0,jsx_runtime.jsx)(icon.A,{icon:"trash",color:styles.yW.light})})]})},f.uid)))})}const btnStyle={padding:"10px"},rotateBtnStyle={padding:"10px",transform:"rotateY(180deg)"},canvasDraw=(modalContent,canvas)=>{const img=modalContent.img,ctx=canvas.getContext("2d"),{times,rotate,left,right}=modalContent;canvas.height=canvas.height;let imgWidth=img.width,imgHeight=img.height;if(imgWidth>imgHeight){let rate=canvas.width/imgWidth;imgWidth=canvas.width*times,imgHeight=canvas.height*rate*times}else{let rate=canvas.height/imgHeight;imgHeight=canvas.height*times,imgWidth=imgWidth*rate*times}const startX=(canvas.width-imgWidth)/2,startY=(canvas.height-imgHeight)/2,midX=canvas.width/2,midY=canvas.height/2;null==ctx||ctx.translate(midX,midY),null==ctx||ctx.rotate(rotate),null==ctx||ctx.drawImage(img,startX-midX+left,startY-midY+right,imgWidth,imgHeight),null==ctx||ctx.translate(0,0)},ImgWraper=styled_components_browser_esm.Ay.div(_templateObject4||(_templateObject4=(0,taggedTemplateLiteral.A)(["\n  display: inline-block;\n  position: relative;\n  width: 104px;\n  height: 104px;\n  margin-right: 8px;\n  margin-bottom: 8px;\n  text-align: center;\n  vertical-align: top;\n  background-color: #fafafa;\n  border: 1px dashed #d9d9d9;\n  border-radius: 2px;\n  cursor: pointer;\n  transition: border-color 0.3s ease;\n  > img {\n    width: 100%;\n    height: 100%;\n  }\n  &::before {\n    position: absolute;\n    left: 0;\n    z-index: 1;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.5);\n    opacity: 0;\n    -webkit-transition: all 0.3s;\n    transition: all 0.3s;\n    content: ' ';\n  }\n  &:hover::before {\n    position: absolute;\n    left: 0;\n    z-index: 1;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.5);\n    opacity: 1;\n    -webkit-transition: all 0.3s;\n    transition: all 0.3s;\n    content: ' ';\n  }\n  &:hover > .closebtn {\n    display: block;\n  }\n"]))),ImageCloseButton=styled_components_browser_esm.Ay.div(_templateObject5||(_templateObject5=(0,taggedTemplateLiteral.A)(["\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  z-index: 2;\n  display: none;\n"]))),ImgUpload=styled_components_browser_esm.Ay.div(_templateObject6||(_templateObject6=(0,taggedTemplateLiteral.A)(["\n  display: inline-block;\n  position: relative;\n  width: 104px;\n  height: 104px;\n  margin-right: 8px;\n  margin-bottom: 8px;\n  text-align: center;\n  vertical-align: top;\n  background-color: #fafafa;\n  border: 1px dashed #d9d9d9;\n  border-radius: 2px;\n  cursor: pointer;\n  transition: border-color 0.3s ease;\n  > svg {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n  }\n"]))),ProgressListItem=styled_components_browser_esm.Ay.div(_templateObject7||(_templateObject7=(0,taggedTemplateLiteral.A)(["\n  display: flex;\n  align-item: center;\n  justify-content: space-between;\n"]))),ProgressLi=styled_components_browser_esm.Ay.li(_templateObject8||(_templateObject8=(0,taggedTemplateLiteral.A)(["\n  list-style: none;\n  padding: 10px;\n  box-shadow: 2px 2px 4px #d9d9d9;\n"])));function Upload(props){const{axiosConfig,onProgress,defaultProgressBar,uploadFilename,successCallback,failCallback,beforeUpload,uploadMode,onRemoveCallback,customRemove,max,accept,multiple}=props,[flist,setFlist]=(0,react.useState)(defaultProgressBar||[]),[resCallback,setResCallback]=(0,react.useState)({restFn:()=>{}}),[modalOpen,setModalOpen]=(0,react.useState)(!1),[modalContent,setModalContent]=(0,react.useState)({rotate:0,times:1,img:new Image,left:0,right:0}),[mouseActive,setMouseActive]=(0,react.useState)(!1),[position,setPosition]=(0,react.useState)({x:0,y:0}),inputRef=(0,react.useRef)(null),canvasRef=(0,react.useRef)(null),handleClick=()=>{var _inputRef$current;null===(_inputRef$current=inputRef.current)||void 0===_inputRef$current||_inputRef$current.click()},onRemove=(0,react.useCallback)((file=>{customRemove?customRemove(file,setFlist):setFlist((prev=>prev.filter((f=>(f.uid===file.uid&&"upload"===f.status&&f.cancel&&f.cancel.cancel(),f.uid!==file.uid))))),onRemoveCallback&&onRemoveCallback(file)}),[onRemoveCallback,setFlist,customRemove]),shouldShow=(0,react.useMemo)((()=>void 0===max||flist.length<max),[max,flist]),showSlice=(0,react.useMemo)((()=>"img"===uploadMode&&!multiple),[multiple,uploadMode]);return(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("input",{ref:inputRef,type:"file",onChange:e=>{if(!e.target.files)return;if(e.target.files&&e.target.files.length<=0)return;Array.from(e.target.files).forEach(((file,i)=>{const restFn=file=>{if(console.log(file,"file-----"),beforeUpload){const p=beforeUpload(file,i);p instanceof Promise?p.then((res=>{postData(res,resolveFilename(uploadFilename,i),axiosConfig,i,onProgress,setFlist,successCallback,failCallback)})):p&&postData(file,resolveFilename(uploadFilename,i),axiosConfig,i,onProgress,setFlist,successCallback,failCallback)}else postData(file,resolveFilename(uploadFilename,i),axiosConfig,i,onProgress,setFlist,successCallback,failCallback)};setResCallback({restFn}),showSlice?(setModalOpen(!0),((f,canvasRef,modalContent)=>{getBase64(f,(s=>{const canvas=canvasRef.current;canvas&&(modalContent.img.src=s,modalContent.img.onload=function(){canvasDraw(modalContent,canvas)})}))})(file,canvasRef,modalContent)):restFn(file)}))},style:{display:"none"},value:"",accept,multiple}),"default"===uploadMode&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[shouldShow&&(0,jsx_runtime.jsx)(components_button.Ay,{onClick:handleClick,isLoading:(flist=>flist.some((f=>"upload"===f.status)))(flist),loadingText:"上传中...",children:"upload"}),(0,jsx_runtime.jsx)(UploadList,{flist,onRemove})]}),"img"===uploadMode&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[shouldShow&&(0,jsx_runtime.jsx)(ImgUpload,{onClick:handleClick,children:(0,jsx_runtime.jsx)(icon.A,{icon:"plus"})}),(0,jsx_runtime.jsx)(ImageList,{flist,onRemove,setFlist})]}),(0,jsx_runtime.jsxs)(modal.Ay,{title:"图片裁剪",callback:v=>{var _canvasRef$current;v&&(null===(_canvasRef$current=canvasRef.current)||void 0===_canvasRef$current||_canvasRef$current.toBlob((function(blob){resCallback.restFn&&resCallback.restFn(blob)})))},maskClose:!0,closeButton:!1,confirm:!0,visible:modalOpen,parentSetState:setModalOpen,children:[(0,jsx_runtime.jsx)("div",{onMouseDown:e=>{setMouseActive(!0),setPosition({x:e.clientX-modalContent.left,y:e.clientY-modalContent.right})},onMouseMove:e=>{if(mouseActive){let dis={x:e.clientX-position.x,y:e.clientY-position.y};const newModalContent={...modalContent,left:dis.x,right:dis.y};setModalContent(newModalContent),canvasDraw(newModalContent,canvasRef.current)}},onMouseUp:()=>{setMouseActive(!1)},onMouseLeave:()=>{setMouseActive(!1)},children:(0,jsx_runtime.jsx)("canvas",{width:300,height:300,style:{width:"100%",height:"100%",border:"1px dashed #ff4785"},ref:canvasRef,children:"您的浏览器不支持canvas"})}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(components_button.Ay,{appearance:"primary",style:btnStyle,onClick:()=>{let newContent={...modalContent,times:modalContent.times+.1};setModalContent(newContent),canvasDraw(newContent,canvasRef.current)},children:(0,jsx_runtime.jsx)(icon.A,{icon:"zoom",color:styles.yW.light})}),(0,jsx_runtime.jsx)(components_button.Ay,{appearance:"primary",style:btnStyle,onClick:()=>{let newContent={...modalContent,times:modalContent.times-.1};setModalContent(newContent),canvasDraw(newContent,canvasRef.current)},children:(0,jsx_runtime.jsx)(icon.A,{icon:"zoomout",color:styles.yW.light})}),(0,jsx_runtime.jsx)(components_button.Ay,{appearance:"primary",style:btnStyle,onClick:()=>{let newContent={...modalContent,rotate:modalContent.rotate-.1};setModalContent(newContent),canvasDraw(newContent,canvasRef.current)},children:(0,jsx_runtime.jsx)(icon.A,{icon:"undo",color:styles.yW.light})}),(0,jsx_runtime.jsx)(components_button.Ay,{appearance:"primary",style:rotateBtnStyle,onClick:()=>{let newContent={...modalContent,rotate:modalContent.rotate+.1};setModalContent(newContent),canvasDraw(newContent,canvasRef.current)},children:(0,jsx_runtime.jsx)(icon.A,{icon:"undo",color:styles.yW.light})}),(0,jsx_runtime.jsx)(components_button.Ay,{appearance:"primary",style:btnStyle,onClick:()=>{let newContent={...modalContent,rotate:0,times:1,left:0,right:0};setModalContent(newContent),canvasDraw(newContent,canvasRef.current)},children:(0,jsx_runtime.jsx)(icon.A,{icon:"zoomreset",color:styles.yW.light})})]})]})]})}Upload.defaultProps={axiosConfig:{},uploadFilename:"avatar",successCallback:()=>message.iU.success("上传成功！"),failCallback:()=>message.iU.error("上传失败！"),uploadMode:"default"},ImageList.__docgenInfo={description:"",methods:[],displayName:"ImageList",props:{flist:{required:!0,tsType:{name:"Array",elements:[{name:"ProgressBar"}],raw:"ProgressBar[]"},description:""},onRemove:{required:!0,tsType:{name:"signature",type:"function",raw:"(item: ProgressBar) => void",signature:{arguments:[{type:{name:"ProgressBar"},name:"item"}],return:{name:"void"}}},description:""},setFlist:{required:!0,tsType:{name:"ReactDispatch",raw:"React.Dispatch<React.SetStateAction<ProgressBar[]>>",elements:[{name:"ReactSetStateAction",raw:"React.SetStateAction<ProgressBar[]>",elements:[{name:"Array",elements:[{name:"ProgressBar"}],raw:"ProgressBar[]"}]}]},description:""}}},Upload.__docgenInfo={description:"",methods:[],displayName:"Upload",props:{uploadFilename:{required:!1,tsType:{name:"union",raw:"string[] | []",elements:[{name:"Array",elements:[{name:"string"}],raw:"string[]"},{name:"tuple",raw:"[]",elements:[]}]},description:"上传字段名",defaultValue:{value:"'avatar'",computed:!1}},axiosConfig:{required:!1,tsType:{name:"Partial",elements:[{name:"AxiosRequestConfig"}],raw:"Partial<AxiosRequestConfig>"},description:"发送设置，参考axios",defaultValue:{value:"{}",computed:!1}},onProgress:{required:!1,tsType:{name:"union",raw:"((p: number, f: File, i: number) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:"获取进度"},successCallback:{required:!1,tsType:{name:"union",raw:"((res: any, i: number) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:"成功回调",defaultValue:{value:"() => message.success('上传成功！')",computed:!1}},failCallback:{required:!1,tsType:{name:"union",raw:"((res: any, i: number) => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:"失败回调",defaultValue:{value:"() => message.error('上传失败！')",computed:!1}},defaultProgressBar:{required:!1,tsType:{name:"Array",elements:[{name:"ProgressBar"}],raw:"ProgressBar[]"},description:"上传列表初始值"},beforeUpload:{required:!1,tsType:{name:"signature",type:"function",raw:"(file: File, i: number) => boolean | Promise<File>",signature:{arguments:[{type:{name:"File"},name:"file"},{type:{name:"number"},name:"i"}],return:{name:"union",raw:"boolean | Promise<File>",elements:[{name:"boolean"},{name:"Promise",elements:[{name:"File"}],raw:"Promise<File>"}]}}},description:"如果返回promise，需要提供file，否则同步需要返回boolean，如果为false，则不发送"},uploadMode:{required:!1,tsType:{name:"union",raw:"'default' | 'img'",elements:[{name:"literal",value:"'default'"},{name:"literal",value:"'img'"}]},description:"上传模式 2种",defaultValue:{value:"'default'",computed:!1}},progress:{required:!1,tsType:{name:"boolean"},description:"是否开启进度列表"},onRemoveCallback:{required:!1,tsType:{name:"signature",type:"function",raw:"(f: ProgressBar) => void",signature:{arguments:[{type:{name:"ProgressBar"},name:"f"}],return:{name:"void"}}},description:"删除文件列表时的回调，只有img与progress为true有效"},customRemove:{required:!1,tsType:{name:"signature",type:"function",raw:"(\n  file: ProgressBar,\n  setFlist: React.Dispatch<React.SetStateAction<ProgressBar[]>>\n) => void",signature:{arguments:[{type:{name:"ProgressBar"},name:"file"},{type:{name:"ReactDispatch",raw:"React.Dispatch<React.SetStateAction<ProgressBar[]>>",elements:[{name:"ReactSetStateAction",raw:"React.SetStateAction<ProgressBar[]>",elements:[{name:"Array",elements:[{name:"ProgressBar"}],raw:"ProgressBar[]"}]}]},name:"setFlist"}],return:{name:"void"}}},description:"自定义删除行为，只有img与progress为true有效"},max:{required:!1,tsType:{name:"number"},description:"允许上传最大容量"},accept:{required:!1,tsType:{name:"string"},description:"input的accept属性"},multiple:{required:!1,tsType:{name:"boolean"},description:"input的multiple属性   multiple为true和max冲突"}}};const upload_stories={title:"Upload",component:Upload},imgUpload=()=>(0,jsx_runtime.jsx)(Upload,{uploadMode:"img"}),defaultUpload=()=>(0,jsx_runtime.jsx)(Upload,{});imgUpload.parameters={...imgUpload.parameters,docs:{...imgUpload.parameters?.docs,source:{originalSource:"() => <Upload uploadMode='img' />",...imgUpload.parameters?.docs?.source}}},defaultUpload.parameters={...defaultUpload.parameters,docs:{...defaultUpload.parameters?.docs,source:{originalSource:"() => <Upload />",...defaultUpload.parameters?.docs?.source}}};const __namedExportsOrder=["imgUpload","defaultUpload"]},"./src/components/message/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ay:()=>Message,iU:()=>message});var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_Users_yangtianbao_learn_framework_plan_React_ant_design_explorer_node_modules_babel_runtime_helpers_esm_taggedTemplateLiteral_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),styled_components__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),react_dom__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-dom/index.js"),_shared_styles__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/components/shared/styles.tsx"),_shared_animation__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/components/shared/animation.tsx"),_icon__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/components/icon/index.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/react/jsx-runtime.js");const MessageText=styled_components__WEBPACK_IMPORTED_MODULE_6__.Ay.span(_templateObject||(_templateObject=(0,_Users_yangtianbao_learn_framework_plan_React_ant_design_explorer_node_modules_babel_runtime_helpers_esm_taggedTemplateLiteral_js__WEBPACK_IMPORTED_MODULE_7__.A)(["\n  display: inline-block;\n  padding: 10px 16px;\n  background: ",";\n  color: ",";\n  font-size: ","px;\n  font-weight: ",";\n  margin: 10px;\n  ",";\n  border-radius: 2px;\n"])),(props=>props.bg),(props=>props.fc),_shared_styles__WEBPACK_IMPORTED_MODULE_2__.Il.size.s2,_shared_styles__WEBPACK_IMPORTED_MODULE_2__.Il.weight.bold,_shared_styles__WEBPACK_IMPORTED_MODULE_2__.Zm),IconWrapper=styled_components__WEBPACK_IMPORTED_MODULE_6__.Ay.span(_templateObject2||(_templateObject2=(0,_Users_yangtianbao_learn_framework_plan_React_ant_design_explorer_node_modules_babel_runtime_helpers_esm_taggedTemplateLiteral_js__WEBPACK_IMPORTED_MODULE_7__.A)(["\n  margin-right: 10px;\n  & > svg {\n    font-size: ","px;\n    ","\n  }\n"])),_shared_styles__WEBPACK_IMPORTED_MODULE_2__.Il.size.s2,(props=>props.spin&&(0,styled_components__WEBPACK_IMPORTED_MODULE_6__.AH)(_templateObject3||(_templateObject3=(0,_Users_yangtianbao_learn_framework_plan_React_ant_design_explorer_node_modules_babel_runtime_helpers_esm_taggedTemplateLiteral_js__WEBPACK_IMPORTED_MODULE_7__.A)(["\n        animation: "," 2s linear infinite;\n      "])),_shared_animation__WEBPACK_IMPORTED_MODULE_3__.G0))),MessageTextWrapper=styled_components__WEBPACK_IMPORTED_MODULE_6__.Ay.div(_templateObject4||(_templateObject4=(0,_Users_yangtianbao_learn_framework_plan_React_ant_design_explorer_node_modules_babel_runtime_helpers_esm_taggedTemplateLiteral_js__WEBPACK_IMPORTED_MODULE_7__.A)(["\n  ","\n  ","\n"])),(props=>props.openState&&(0,styled_components__WEBPACK_IMPORTED_MODULE_6__.AH)(_templateObject5||(_templateObject5=(0,_Users_yangtianbao_learn_framework_plan_React_ant_design_explorer_node_modules_babel_runtime_helpers_esm_taggedTemplateLiteral_js__WEBPACK_IMPORTED_MODULE_7__.A)(["\n      animation: "," ","s ease-in;\n    "])),_shared_animation__WEBPACK_IMPORTED_MODULE_3__.dH,props.ani/1e3)),(props=>props.closeState&&(0,styled_components__WEBPACK_IMPORTED_MODULE_6__.AH)(_templateObject6||(_templateObject6=(0,_Users_yangtianbao_learn_framework_plan_React_ant_design_explorer_node_modules_babel_runtime_helpers_esm_taggedTemplateLiteral_js__WEBPACK_IMPORTED_MODULE_7__.A)(["\n      animation: "," ","s ease-in;\n    "])),_shared_animation__WEBPACK_IMPORTED_MODULE_3__.rA,props.ani/1e3)));let wrap;function createMessage(type){return function(content){const fconfig={...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},...defaultConfig};wrap||(wrap=document.createElement("div"),wrap.style.cssText="\n        line-height: 1.5;\n        text-align: center;\n        color: #333;\n        box-sizing: border-box;\n        margin: 0;\n        padding: 0;\n        list-style: none;\n        position: fixed;\n        z-index: 100000;\n        width: 100%;\n        top: 16px;\n        left: 0;\n        pointer-events: none;\n      ",wrap&&document.body&&document.body.appendChild(wrap));const divs=document.createElement("div");wrap.appendChild(divs),react_dom__WEBPACK_IMPORTED_MODULE_1__.render((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(Message,{rootDom:wrap,parentDom:divs,content,fconfig,iconType:type}),divs)}}const defaultConfig={mount:document.body,delay:2e3,callback:null,animationDuration:300,background:_shared_styles__WEBPACK_IMPORTED_MODULE_2__.yW.lightest,color:_shared_styles__WEBPACK_IMPORTED_MODULE_2__.yW.dark};function Message(props){const{rootDom,parentDom,content,fconfig,iconType}=props,[close,setClose]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),renderIcon=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>{switch(iconType){case"default":default:return null;case"info":return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(IconWrapper,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_icon__WEBPACK_IMPORTED_MODULE_4__.A,{icon:"info",size:"middle",color:_shared_styles__WEBPACK_IMPORTED_MODULE_2__.yW.primary})});case"success":return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(IconWrapper,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_icon__WEBPACK_IMPORTED_MODULE_4__.A,{icon:"check",size:"middle",color:_shared_styles__WEBPACK_IMPORTED_MODULE_2__.yW.positive})});case"error":return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(IconWrapper,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_icon__WEBPACK_IMPORTED_MODULE_4__.A,{icon:"closeAlt",size:"small",color:_shared_styles__WEBPACK_IMPORTED_MODULE_2__.yW.negative})});case"warning":return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(IconWrapper,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_icon__WEBPACK_IMPORTED_MODULE_4__.A,{icon:"info",size:"middle",color:_shared_styles__WEBPACK_IMPORTED_MODULE_2__.yW.warning})});case"loading":return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(IconWrapper,{spin:!0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_icon__WEBPACK_IMPORTED_MODULE_4__.A,{icon:"sync",size:"middle"})})}}),[iconType]),unmount=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>()=>{parentDom&&rootDom&&((0,react_dom__WEBPACK_IMPORTED_MODULE_1__.unmountComponentAtNode)(parentDom),rootDom.removeChild(parentDom))}),[parentDom,rootDom]);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{const closeStart=fconfig.delay-fconfig.animationDuration,timer=window.setTimeout((()=>{setClose(!0)}),closeStart>0?closeStart:0),timer2=setTimeout((()=>{setClose(!0),unmount()}),fconfig.delay);return()=>{window.clearTimeout(timer),window.clearTimeout(timer2)}}),[unmount,fconfig]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(MessageTextWrapper,{openState:!0,closeState:close,ani:fconfig.animationDuration,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(MessageText,{bg:fconfig.background,fc:fconfig.color,children:[renderIcon,content]})})}const message={info:createMessage("info"),success:createMessage("success"),error:createMessage("error"),warning:createMessage("warning"),loading:createMessage("loading"),default:createMessage("default")};Message.__docgenInfo={description:"",methods:[],displayName:"Message",props:{rootDom:{required:!0,tsType:{name:"HTMLElement"},description:""},parentDom:{required:!0,tsType:{name:"union",raw:"Element | DocumentFragment",elements:[{name:"Element"},{name:"DocumentFragment"}]},description:""},content:{required:!0,tsType:{name:"ReactNode"},description:""},fconfig:{required:!0,tsType:{name:"MessageConfig"},description:""},iconType:{required:!0,tsType:{name:"union",raw:'"info" | "success" | "error" | "warning" | "loading" | "default"',elements:[{name:"literal",value:'"info"'},{name:"literal",value:'"success"'},{name:"literal",value:'"error"'},{name:"literal",value:'"warning"'},{name:"literal",value:'"loading"'},{name:"literal",value:'"default"'}]},description:""}}}},"./src/components/progress/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>Progress});var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_Users_yangtianbao_learn_framework_plan_React_ant_design_explorer_node_modules_babel_runtime_helpers_esm_taggedTemplateLiteral_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),styled_components__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),_shared_styles__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/components/shared/styles.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");const progressFlash=(0,styled_components__WEBPACK_IMPORTED_MODULE_3__.i7)(_templateObject||(_templateObject=(0,_Users_yangtianbao_learn_framework_plan_React_ant_design_explorer_node_modules_babel_runtime_helpers_esm_taggedTemplateLiteral_js__WEBPACK_IMPORTED_MODULE_4__.A)(["\n  0% { opacity: 0.1;\n    width: 0; \n  }\n  20% { opacity: 0.5;\n    width: 0; \n  } \n  100% { opacity: 0;\n    width: 100%; \n  }\n"]))),BarWrapper=styled_components__WEBPACK_IMPORTED_MODULE_3__.Ay.div(_templateObject2||(_templateObject2=(0,_Users_yangtianbao_learn_framework_plan_React_ant_design_explorer_node_modules_babel_runtime_helpers_esm_taggedTemplateLiteral_js__WEBPACK_IMPORTED_MODULE_4__.A)(["\n\tdisplay: flex;\n\tpadding: 5px;\n\talign-items: center;\n"]))),BarMain=styled_components__WEBPACK_IMPORTED_MODULE_3__.Ay.div(_templateObject3||(_templateObject3=(0,_Users_yangtianbao_learn_framework_plan_React_ant_design_explorer_node_modules_babel_runtime_helpers_esm_taggedTemplateLiteral_js__WEBPACK_IMPORTED_MODULE_4__.A)(["\n  width: ","%;\n  height: ","px;\n  background-color: ",";\n  background-image: linear-gradient(\n    to right,\n    ",",\n    ","\n  );\n  transition: all 0.4s cubic-bezier(0.08, 0.82, 0.17, 1) 0s;\n  border-radius: 5px;\n  position: relative;\n  &::before {\n    animation: "," 2.4s cubic-bezier(0.23, 1, 0.32, 1) infinite;\n    background: ",";\n    border-radius: 10px;\n    bottom: 0;\n    content: '';\n    left: 0;\n    opacity: 0;\n    position: absolute;\n    right: 0;\n    top: 0;\n  }\n"])),(props=>props.state),(props=>props.height?props.height:8),(props=>props.primary),(props=>props.primary),(props=>props.secondary),progressFlash,(props=>props.flashColor)),BarMainWrapper=styled_components__WEBPACK_IMPORTED_MODULE_3__.Ay.div(_templateObject4||(_templateObject4=(0,_Users_yangtianbao_learn_framework_plan_React_ant_design_explorer_node_modules_babel_runtime_helpers_esm_taggedTemplateLiteral_js__WEBPACK_IMPORTED_MODULE_4__.A)(["\n  width: 100%;\n  border-radius: 5px;\n  position: relative;\n  background: ",",\n  height: ","px,\n"])),(props=>props.bottomColor),(props=>props.height?props.height:8)),BarText=styled_components__WEBPACK_IMPORTED_MODULE_3__.Ay.div(_templateObject5||(_templateObject5=(0,_Users_yangtianbao_learn_framework_plan_React_ant_design_explorer_node_modules_babel_runtime_helpers_esm_taggedTemplateLiteral_js__WEBPACK_IMPORTED_MODULE_4__.A)(["\n  line-height: ","px;\n  font-weight: ",";\n  text-align: center;\n  display: inline-block;\n  margin-left: 10px;\n  min-width: 55px;\n"])),(props=>props.height?props.height:8),_shared_styles__WEBPACK_IMPORTED_MODULE_1__.Il.weight.bold),CircleWrapper=styled_components__WEBPACK_IMPORTED_MODULE_3__.Ay.div(_templateObject6||(_templateObject6=(0,_Users_yangtianbao_learn_framework_plan_React_ant_design_explorer_node_modules_babel_runtime_helpers_esm_taggedTemplateLiteral_js__WEBPACK_IMPORTED_MODULE_4__.A)(["\n  position: relative;\n  display: inline-block;\n  border-radius: 50%;\n"]))),CircleText=styled_components__WEBPACK_IMPORTED_MODULE_3__.Ay.div(_templateObject7||(_templateObject7=(0,_Users_yangtianbao_learn_framework_plan_React_ant_design_explorer_node_modules_babel_runtime_helpers_esm_taggedTemplateLiteral_js__WEBPACK_IMPORTED_MODULE_4__.A)(["\n  line-height: ","px;\n  width: ","px;\n  height: ","px;\n  border-radius: 50%;\n  display: inline-block;\n  font-weight: ",";\n  left: 50%;\n  position: absolute;\n  text-align: center;\n  top: 50%;\n  transform: translateX(-50%) translateY(-50%);\n"])),(props=>.62*props.size),(props=>.62*props.size),(props=>.62*props.size),_shared_styles__WEBPACK_IMPORTED_MODULE_1__.Il.weight.bold);function Progress(props){const{count,countNumber,height,circle,size,circleText,progressText,bottomColor,style,className,flashColor,primary,secondary}=props,[state,setState]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(0),[dasharray,setDasharray]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)("");(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>{setState(count<0?0:count>100?100:count)}),[count]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{if(circle){const percent=state/100,perimeter=2*Math.PI*170;setDasharray(perimeter*percent+""+perimeter*(1-percent))}}),[circle,state]);const render=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>circle?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(CircleWrapper,{style,className,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("svg",{width:size,height:size,viewBox:"0 0 420 420",style:{transform:"rotate(270deg)"},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("defs",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("radialGradient",{id:"linear",r:"100%",cx:"100%",cy:"100%",spreadMethod:"pad",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("stop",{offset:"0%",stopColor:"#40a9ff"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("stop",{offset:"100%",stopColor:"#36cfc9"})]})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("circle",{cx:"210",cy:"210",r:"170",strokeWidth:"40",stroke:"#f5f5f5",fill:"none"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("circle",{cx:"210",cy:"210",r:"170",strokeWidth:"40",stroke:"url(#linear)",fill:"none",opacity:0===state?0:1,strokeLinecap:"round",strokeDasharray:dasharray,strokeDashoffset:"0px",style:{transition:"stroke-dashoffset 0.3s ease 0s, stroke-dasharray 0.3s ease 0s, stroke 0.3s ease 0s, stroke-width 0.06s ease 0.3s"}})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{style:{lineHeight:"".concat(.6*size,"px"),width:"".concat(.6*size,"px"),height:"".concat(.62*size,"px")},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(CircleText,{size,children:progressText||"".concat(state,"%")})})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(BarWrapper,{style,className,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(BarMainWrapper,{bottomColor,height,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(BarMain,{flashColor,primary,secondary,state,height})}),countNumber&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(BarText,{height,children:progressText||"".concat(state,"%")})]})),[circle,state,height,progressText,size,countNumber,dasharray,flashColor,primary,secondary,bottomColor,className,style]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:render})}Progress.defaultProps={countNumber:!0,circle:!1,size:100,primary:_shared_styles__WEBPACK_IMPORTED_MODULE_1__.yW.primary,secondary:_shared_styles__WEBPACK_IMPORTED_MODULE_1__.yW.gold,flashColor:_shared_styles__WEBPACK_IMPORTED_MODULE_1__.yW.lightest,bottomColor:_shared_styles__WEBPACK_IMPORTED_MODULE_1__.yW.medium},Progress.__docgenInfo={description:"",methods:[],displayName:"Progress",props:{count:{required:!0,tsType:{name:"number"},description:"进度值"},countNumber:{required:!1,tsType:{name:"boolean"},description:"是否要末尾计数文本",defaultValue:{value:"true",computed:!1}},height:{required:!1,tsType:{name:"number"},description:"进度条高度 环状不生效"},circle:{required:!1,tsType:{name:"boolean"},description:"是否是环状",defaultValue:{value:"false",computed:!1}},size:{required:!1,tsType:{name:"number"},description:"环状大小",defaultValue:{value:"100",computed:!1}},circleText:{required:!1,tsType:{name:"ReactNode"},description:"自定义环状文本"},progressText:{required:!1,tsType:{name:"ReactNode"},description:"自定义长条进度文本"},bottomColor:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'#DDDDDD'",computed:!1}},style:{required:!1,tsType:{name:"CSSProperties"},description:""},className:{required:!1,tsType:{name:"string"},description:""},flashColor:{required:!1,tsType:{name:"string"},description:"长条闪烁动画颜色",defaultValue:{value:"'#FFFFFF'",computed:!1}},primary:{required:!1,tsType:{name:"string"},description:"主色",defaultValue:{value:"'#FF4785'",computed:!1}},secondary:{required:!1,tsType:{name:"string"},description:"副色",defaultValue:{value:"'#FFAE00'",computed:!1}}}}}}]);